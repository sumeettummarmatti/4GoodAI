Multi-Class Surface Defect Detection ApproachThis project implements an end-to-end deep learning pipeline to identify and categorize six distinct types of surface defects in metal materials: Crazing, Inclusion, Patches, Pitted, Rolled-in Scale, and Scratches.1. Model ArchitectureThe system utilizes a custom ScratchDetector class that enhances a standard backbone with spatial awareness.Backbone: ResNet-50 (Pretrained on ImageNet). We remove the final global pooling and classification layers to preserve spatial feature maps.Spatial Attention Module: A custom module that computes channel-wise statistics (Average and Max pooling) followed by a $7 \times 7$ convolution to generate a spatial attention map. This allows the model to "focus" on localized defect regions rather than the entire surface.Classification Head: A multi-layer MLP consisting of Dropout ($p=0.3$), a Linear layer (512 units), ReLU activation, and a final Linear layer outputting probabilities for 6 classes.2. Training StrategyTo achieve high accuracy on complex surface textures, we employed several advanced techniques:Loss Function: Focal Loss ($\gamma=2.0$, $\alpha=0.75$). This specifically addresses class imbalance and forces the model to focus on "hard-to-classify" examples during training.Data Augmentation (Albumentations):Geometric: Random rotations (180Â°), elastic transformations, and optical distortions to simulate material warping.Photometric: CLAHE (Contrast Limited Adaptive Histogram Equalization) for contrast enhancement, Gaussian noise, and various blur techniques (Motion, Gaussian, Median) to simulate sensor variations and lighting changes.Optimization: AdamW optimizer with a Cosine Annealing Learning Rate Scheduler to ensure smooth convergence.3. Explainability (Grad-CAM)To ensure the model is reliable and "looking" at the actual defect, we integrated Grad-CAM (Gradient-weighted Class Activation Mapping).Method: The system extracts gradients from the final convolutional block (backbone.blocks[-1]).Visualization: It generates a heatmap overlay on the original image, highlighting the specific areas that triggered the classification (e.g., the specific line of a scratch).4. Performance & ResultsBased on the final evaluation on the test set:Accuracy: Achieved 100% Validation Accuracy across all 6 classes.Classes: Crazing, Inclusion, Patches, Pitted, Rolled-in Scale, Scratches.Hardware: Currently optimized for CPU/GPU inference.5. User InterfaceThe model is deployed via a Gradio web interface in src/app.py.Input: Users upload a raw surface image.Output: Real-time prediction of defect category and confidence level.Explainability: Interactive heatmap showing exactly where the defect was detected.